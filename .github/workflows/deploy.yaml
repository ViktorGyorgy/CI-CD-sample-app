name: Deploy
on:
  push:
    branches:
      - '**'
jobs:
  build:
    runs-on: self-hosted
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v3
        with:
          node-version: 20
      - name: Installing node dependencies
        run: npm ci
      - name: Create docker tar from files
        run: npm run docker-tar
      - name: Save ssh key
        run: echo "Key" > key.pem
      - name: Send ssh key to server
        run: scp -i ./key.pem ec2-user@51.21.128.140 ./sample.tar .
